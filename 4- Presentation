create or replace view PRESENTATION_DB.PUBLIC.VW_BOOKINGS_MASTER(
	"VW_BOOKINGS_MASTER_ID%" COMMENT 'Primary key for data set = sales order & line item',
	"Sales Order",
	"Sales Order Line",
	"Sales Order and Line" COMMENT 'Concatenated sales order with line number',
	"Order Date" COMMENT 'Date of order - manual entry',
	"Entry System Date" COMMENT 'Date sales order is created - auto-entry',
	"Line Ship Date" COMMENT 'From MLINESHIPDATE of SorDetail',
	"Min Promise Date" COMMENT 'Earliest entered promise date from CusSorDetailMerch+',
	"Max Promise Date" COMMENT 'Lastest entered promise date from CusSorDetailMerch+',
	"Order Status" COMMENT 'Status code of Sales order (from SorMaster table)',
	"Order Status Description" COMMENT 'Sales order status description',
	"Order Status and Description" COMMENT 'Concatenated order status with description',
	"Order Type" COMMENT 'Order type for Sales order',
	"Order Type Description" COMMENT 'Order type description for sales order',
	"Order Type and Description" COMMENT 'Concatenated order type with description in sales order',
	"Is Future Order Date" COMMENT 'Flag for determining future shipment orders; based on promise date (null promise dates are considered future)',
	"Line Type" COMMENT 'Line type from sales order line',
	"Line Type Description" COMMENT 'Description of line type from Sales order line',
	"Line Type and Description" COMMENT 'Concatenated line type with description for sales order line',
	"Document Type" COMMENT 'Document type for sales order',
	"Document Type Description" COMMENT 'Document type description for sales order',
	"Document Type and Description" COMMENT 'Concatenated document type w/ description for sales order',
	"Customer Class" COMMENT 'From customer master record (ArCustomer table)',
	"Customer Class Description" COMMENT 'From customer master record (ArCustomer table)',
	"Customer Class and Description" COMMENT 'Concatenated customer class with description',
	"Customer Number",
	"Customer Name" COMMENT 'Name as recorded in sales order (SorMaster table)',
	"Customer Master Name" COMMENT 'Name as recorded in customer master (ArCustomer table)',
	"Customer Number and Name" COMMENT 'Concatenated customer and name sourced from Sales order table (SorMaster)',
	"Customer Number and Master Name" COMMENT 'Concatenated customer and master name sourced from customer master table (ArCustomer)',
	"Customer PO Number",
	"Is International Customer" COMMENT 'Calculated flag indicating if customer if international or domestic',
	"Is Consumer Customer" COMMENT 'Calculated flag indicating if customer is consumer (vs. dealer)',
	"Is Flagged Inactive Customer" COMMENT 'Calculated flag indicating if customer is active',
	"Customer Email" COMMENT 'Customer email from master record',
	"Customer Email (Order)" COMMENT 'Customer email from sales order',
	"Ship Address 1",
	"Ship Address 2",
	"Ship Address 3",
	"Ship Address 3 Loc",
	"Ship Address 4",
	"Ship Address 5",
	"Ship Postal Code",
	"Sold to Address 1",
	"Sold to Address 2",
	"Sold to Address 3",
	"Sold to Address 3 Loc",
	"Sold to Address 4",
	"Sold to Address 5",
	"Sold to Postal Code",
	"Branch",
	"Branch Description",
	"Branch and Description" COMMENT 'Concatenated branch w/ description',
	"Agency" COMMENT 'Agency of salesperson assigned to sales order',
	"Agency Master" COMMENT 'Agency of salesperson assigned to customer master',
	"Salesperson Code" COMMENT 'Salesperson code recorded in sales order',
	"Salesperson Name" COMMENT 'Salesperson name recorded in sales order',
	"Salesperson Code and Name" COMMENT 'Concatenated salesperson code with name',
	"Salesperson Master Code" COMMENT 'Code from salesperson master record (via customer master table ArCustomer)',
	"Salesperson Master Name" COMMENT 'Salesperon name records in master record (via customer master table ArCustomer)',
	"Salesperson Master Code and Name" COMMENT 'Concatenated code and name from master record (via customer master table ArCustomer)',
	"Is Active Salesperson" COMMENT 'Calculated flag indicating if salesperson from sales order is active',
	"Is Active Salesperson Master" COMMENT 'Calculated flag indicating if salesperson from customer master is active',
	"Product Family Master",
	"Product Class",
	"Product Class Description",
	"Product Class Original Description",
	"Product Class Master",
	"Product Class Description Master",
	"Product Class Original Description Master",
	"Stock Code",
	"Stock Code Description",
	"Stock Code Master",
	"Stock Code Master Description",
	"Mechanism",
	"Ship Qty",
	"Backorder Qty",
	"Order Qty",
	"Gross Unit Cost",
	"Gross Total Cost",
	"Gross Unit Booking Value",
	"Gross Total Booking Value",
	"Is Knife Line" COMMENT 'Calculated based on product class',
	"Custom Knife Flag" COMMENT 'Calculated based on product class, line type, and stock code description',
	"Cutlery Knife Flag" COMMENT 'Calculated based on product class, line type, and stock code',
	"Is NPI Line" COMMENT 'Calculated  based on entry system date, first customer ship, and Is Knife Line flag',
	"Line Category" COMMENT 'Calculated string categorizing line items based on custom flags is knife line, custom and cutlery flags',
	"Knife Qty" COMMENT 'Order qty if a knife line; 0 otherwise',
	"Charge Code",
	"Charge Description",
	"Customer Sub-Category",
	"Is Open Order",
	"Is Past Due Order Line"
) COMMENT='Master view for bookings - sales order line detail'
 as
/*
* ---------------------------------------------------------------------------------------------------------
* Created       CreatedBy           Description
* ---------------------------------------------------------------------------------------------------------
* 12/19/2022    Kevin Bailey        Added "Is Open Order" field so that dataset can be used to derive
*                                   backlog data.
*                                   Added "Is Past Due Order Line" for past due drill down analysis
* 12/12/2022    Kevin Bailey        Added field "Customer Email (Order)"
* 12/02/2022    Kevin Bailey        Added field "Customer Sub-Category"
* 11/08/2022    Kevin Bailey        Added field ISNPI_LINEITEM from BL layer
* 11/01/2022    Kevin Bailey        Added field AGENCY_MASTER, Is Active Salesperson Master
*                                   Added charge code and charge description
* 10/31/2022    Kevin Bailey        Added LineCategory, Knife Qty, Agency fields
* 10/27/2022    Kevin Bailey        Added product class master data fields
* 10/26/2022    Kevin Bailey        Added IS_KNIFE_LINE, CUSTOMER_KNIFE_FLAG, and CUTLERY_KNIFE_FLAG
*                                   fields based on new functions
* 10/25/2022    Kevin Bailey        Added masked customer names  
* 10/24/2022    Kevin Bailey        Initial creation
*/

SELECT  "BL_BOOKINGS_MASTER_ID%",
        SALESORDER,
        SALESORDERLINE,
        SALESORDER_AND_LINE,
        ORDERDATE,
        ENTRYSYSTEMDATE,
        MLINESHIPDATE,
        MIN_PROMISEDATE,
        MAX_PROMISEDATE,
        ORDERSTATUS,
        ORDERSTATUSDESCRIPTION,
        ORDERSTATUS_AND_DESCRIPTION,
        ORDERTYPE,
        ORDERTYPE_DESCRIPTION,
        ORDERTYPE_AND_DESCRIPTION,
        ISFUTURE_ORDERDATE,
        LINETYPE,
        LINETYPE_DESCRIPTION,
        LINETYPE_AND_DESCRIPTION,
        DOCUMENTTYPE,
        DOCUMENTTYPEDES,
        DOCUMENTTYPE_AND_DESCRIPTION,
        CUSTOMER_CLASS,
        CUSTOMER_CLASS_DESCRIPTION,
        CUSTOMER_CLASS_AND_DESCRIPTION,
        CUSTOMER_NUMBER,
        CUSTOMER_NAME_MASKED,
        CUSTOMER_MASTER_NAME_MASKED,
        CUSTOMER_NUMBER_AND_NAME_MASKED,
        CUSTOMER_NUMBER_AND_MASTER_NAME_MASKED,
        CUSTOMERPONUMBER,
        ISINTERNATIONAL_CUSTOMER,
        ISCONSUMER_CUSTOMER,
        ISFLAGGEDINACTIVE_CUSTOMER,
        CUSTOMER_EMAIL,
        CUSTOMER_EMAIL_SALESORDER,
        SHIPADDRESS1,
        SHIPADDRESS2,
        SHIPADDRESS3,
        SHIPADDRESS3LOC,
        SHIPADDRESS4,
        SHIPADDRESS5,
        SHIPPOSTALCODE,
        SOLDTOADDR1,
        SOLDTOADDR2,
        SOLDTOADDR3,
        SOLDTOADDR3LOC,
        SOLDTOADDR4,
        SOLDTOADDR5,
        SOLDPOSTALCODE,
        BRANCH,
        BRANCH_DESCRIPTION,
        BRANCH_AND_DESCRIPTION,
        AGENCY,
        AGENCY_MASTER,
        SALESPERSON_CODE,
        SALESPERSON_NAME,
        SALESPERSON_CODE_AND_NAME,
        SALESPERSON_MASTER_CODE,
        SALESPERSON_MASTER_NAME,
        SALESPERSON_MASTER_CODE_AND_NAME,
        ISACTIVE_SALESPERSON,
        ISACTIVE_SALESPERSON_MASTER,
        PRODUCTFAMILY_MASTER,
        MPRODUCTCLASS,
        PRODUCTCLASS_DESCRIPTION,
        PRODUCTCLASS_ORIGINAL_DESCRIPTION,
        PRODUCTCLASS_MASTER,
        PRODUCTCLASS_DESCRIPTION_MASTER,
        PRODUCTCLASS_ORIGINAL_DESCRIPTION_MASTER,
        MSTOCKCODE,
        MSTOCKDES,
        STOCKCODE_MASTER,
        STOCKCODE_MASTER_DESCRIPTION,
        MECHANISM,
        MSHIPQTY,
        MBACKORDERQTY,
        MORDERQTY,
        GROSS_UNIT_COST,
        GROSS_TOTAL_COST,
        GROSS_UNIT_BOOKING_VALUE,
        GROSS_TOTAL_BOOKING_VALUE,
        IS_KNIFE_LINE,
        CUSTOM_KNIFE_FLAG,
        CUTLERY_KNIFE_FLAG,
        ISNPI_LINEITEM,
        LINECATEGORY,
        KNIFEQTY,
        NCHARGECODE,
        CHARGEDESCRIPTION,
        CUSTOMERSUBCATEGOR,
        ISOPENORDER,
        ISPASTDUEORDERLINE
FROM    BUSINESS_LOGIC_DB.PUBLIC.BL_BOOKINGS_MASTER;
